Name: xs-opam
Version: 0.0.1
Release: 1%{?dist}
Summary: Opam repository
License: Various
URL: http://localhost/src/
AutoReqProv: no

Source000: https://github.com/lindig/xs-opam/archive/master/xs-opam-master.tar.gz
# generate this list with "make sources.spec" in the repo above
Source001: https://github.com/inhabitedtype/angstrom/archive/0.1.1/angstrom-0.1.1.tar.gz
Source002: http://erratique.ch/software/astring/releases/astring-0.8.3.tbz
Source003: https://ocaml.janestreet.com/ocaml-core/113.33/files/async-113.33.03.tar.gz
Source004: https://ocaml.janestreet.com/ocaml-core/113.33/files/async_extra-113.33.03.tar.gz
Source005: https://ocaml.janestreet.com/ocaml-core/113.33/files/async_kernel-113.33.03.tar.gz
Source006: https://ocaml.janestreet.com/ocaml-core/113.33/files/async_rpc_kernel-113.33.03.tar.gz
Source007: https://ocaml.janestreet.com/ocaml-core/113.33/files/async_unix-113.33.03.tar.gz
Source008: https://github.com/mirage/ocaml-base64/releases/download/v2.1.2/base64-2.1.2.tbz
Source009: https://github.com/mjambon/biniou/archive/v1.0.12/biniou-v1.0.12.tar.gz
Source010: https://ocaml.janestreet.com/ocaml-core/113.33/files/bin_prot-113.33.03.tar.gz
Source011: http://bisect.x9c.fr/distrib/bisect-1.3.tar.gz
Source012: https://github.com/aantron/bisect_ppx/archive/1.2.0/bisect_ppx-1.2.0.tar.gz
Source013: http://erratique.ch/software/bos/releases/bos-0.1.4.tbz
Source014: https://github.com/ocaml/camlp4/archive/system.0.tar.gz
Source015: https://forge.ocamlcore.org/frs/download.php/1616/camlzip-1.06.tar.gz
Source016: https://github.com/yoriyuki/Camomile/releases/download/rel-0.8.5/camomile-0.8.5.tar.bz2
Source017: https://github.com/mirage/mirage-channel/releases/download/v1.1.1/channel-1.1.1.tbz
Source018: http://erratique.ch/software/cmdliner/releases/cmdliner-0.9.8.tbz
Source019: https://github.com/mirage/ocaml-cohttp/archive/v0.21.0/ocaml-cohttp-v0.21.0.tar.gz
Source020: https://github.com/mirage/ocaml-conduit/archive/v0.13.0/ocaml-conduit-v0.13.0.tar.gz
Source021: https://ocaml.janestreet.com/ocaml-core/113.33/files/core-113.33.03.tar.gz
Source022: https://ocaml.janestreet.com/ocaml-core/113.33/files/core_kernel-113.33.03.tar.gz
Source023: https://github.com/mirage/ocaml-cow/releases/download/v2.2.0/cow-2.2.0.tbz
Source024: https://github.com/mjambon/cppo/archive/v1.4.1/cppo-v1.4.1.tar.gz
Source025: https://github.com/xapi-project/ocaml-crc/archive/1.0.0/ocaml-crc-1.0.0.tar.gz
Source026: https://github.com/mirage/ocaml-crunch/archive/v1.4.1/ocaml-crunch-v1.4.1.tar.gz
Source027: https://github.com/fdopen/cryptohash/releases/download/0.1.1/cryptohash-0.1.1.tar.gz
Source028: https://forge.ocamlcore.org/frs/download.php/1618/cryptokit-1.11.tar.gz
Source029: https://github.com/mirage/ocaml-cstruct/archive/v2.3.0/ocaml-cstruct-v2.3.0.tar.gz
Source030: https://github.com/Chris00/ocaml-csv/releases/download/1.5/csv-1.5.tar.gz
Source031: https://github.com/ocamllabs/ocaml-ctypes/archive/0.11.1/ocaml-ctypes-0.11.1.tar.gz
Source032: https://gforge.inria.fr/frs/download.php/33593/cudf-0.7.tar.gz
Source033: https://github.com/ocaml/opam-depext/archive/1.0.2/opam-depext-1.0.2.tar.gz
Source034: https://github.com/mirage/ocaml-dns/archive/v0.18.1/ocaml-dns-v0.18.1.tar.gz
Source035: https://gforge.inria.fr/frs/download.php/file/33677/dose3-3.2.2.tar.gz
Source036: https://github.com/mjambon/easy-format/archive/v1.2.0/easy-format-v1.2.0.tar.gz
Source037: http://ygrek.org.ua/p/release/ocaml-extlib/extlib-1.7.1.tar.gz
Source038: https://github.com/mirage/ezjsonm/archive/0.4.3/ezjsonm-0.4.3.tar.gz
Source039: https://github.com/avsm/ezxmlm/archive/v1.0.1/ezxmlm-v1.0.1.tar.gz
Source040: https://github.com/xen-org/ocaml-fd-send-recv/archive/ocaml-fd-send-recv-1.0.1.tar.gz
Source041: https://ocaml.janestreet.com/ocaml-core/113.33/files/fieldslib-113.33.03.tar.gz
Source042: http://erratique.ch/software/fmt/releases/fmt-0.8.0.tbz
Source043: http://erratique.ch/software/fpath/releases/fpath-0.7.1.tbz
Source044: https://github.com/mirage/functoria/archive/1.1.1/functoria-1.1.1.tar.gz
Source045: http://erratique.ch/software/gg/releases/gg-0.9.1.tbz
Source046: https://github.com/mirage/ocaml-git/archive/1.8.0/ocaml-git-1.8.0.tar.gz
Source047: https://github.com/backtracking/ocaml-hashcons/archive/1.2/ocaml-hashcons-1.2.tar.gz
Source048: https://github.com/mirage/ocaml-hex/archive/1.0.0/ocaml-hex-1.0.0.tar.gz
Source049: https://github.com/mirage/io-page/archive/v1.6.1/io-page-v1.6.1.tar.gz
Source050: https://github.com/mirage/io-page/archive/v0.9.9/io-page-v0.9.9.tar.gz
Source051: https://github.com/mirage/ocaml-ipaddr/releases/download/2.7.1/ipaddr-2.7.1.tbz
Source052: https://github.com/mirage/irmin/releases/download/0.12.0/irmin-0.12.0.tbz
Source053: https://github.com/samoht/irmin-watcher/releases/download/0.2.0/irmin-watcher-0.2.0.tbz
Source054: https://ocaml.janestreet.com/ocaml-core/113.33/files/js-build-tools-113.33.04.tar.gz
Source055: https://github.com/ocsigen/js_of_ocaml/archive/2.8.3/js_of_ocaml-2.8.3.tar.gz
Source056: http://erratique.ch/software/jsonm/releases/jsonm-0.9.1.tbz
Source057: https://github.com/aantron/lambda-soup/archive/0.6/lambda-soup-0.6.tar.gz
Source058: https://github.com/diml/lambda-term/archive/1.10.1/lambda-term-1.10.1.tar.gz
Source059: https://github.com/lindig/lipsum/archive/v0.2/lipsum-0.2.zip
Source060: http://erratique.ch/software/logs/releases/logs-0.6.2.tbz
Source061: https://github.com/ocsigen/lwt/archive/2.6.0/lwt-2.6.0.tar.gz
Source062: https://github.com/mirage/ocaml-magic-mime/archive/v1.0.0/ocaml-magic-mime-v1.0.0.tar.gz
Source063: https://github.com/aantron/markup.ml/archive/0.7.2/markup.ml-0.7.2.tar.gz
Source064: http://gallium.inria.fr/~fpottier/menhir/menhir-20161115.tar.gz
Source065: https://github.com/the-lambda-church/merlin/archive/v2.5.3/merlin-v2.5.3.tar.gz
Source066: http://github.com/mirage/mirage-block/archive/v0.2/mirage-block-v0.2.tar.gz
Source067: https://github.com/mirage/mirage-block-unix/archive/v2.4.0/mirage-block-unix-v2.4.0.tar.gz
Source068: https://github.com/mirage/mirage-clock/archive/v1.0.0/mirage-clock-v1.0.0.tar.gz
Source069: https://github.com/mirage/mirage-console/archive/v2.1.3/mirage-console-v2.1.3.tar.gz
Source070: https://github.com/mirage/mirage-flow/archive/v1.1.0/mirage-flow-v1.1.0.tar.gz
Source071: https://github.com/mirage/mirage-http/releases/download/2.5.3/mirage-http-2.5.3.tbz
Source072: https://github.com/mirage/mirage-profile/archive/v0.7.0/mirage-profile-v0.7.0.tar.gz
Source073: https://github.com/mirage/mirage-tc/archive/0.3.0/mirage-0.3.0.tar.gz
Source074: https://github.com/mirage/mirage/archive/v2.8.0/mirage-v2.8.0.tar.gz
Source075: https://github.com/mirage/mirage-platform/archive/v2.6.0/mirage-platform-v2.6.0.tar.gz
Source076: https://github.com/mirage/ocaml-mstruct/archive/1.3.2/ocaml-mstruct-1.3.2.tar.gz
Source077: https://github.com/xapi-project/ocaml-netlink/archive/v0.2.1/ocaml-netlink-v0.2.1.tar.gz
Source078: https://github.com/mirleft/ocaml-nocrypto/archive/v0.5.3/ocaml-nocrypto-v0.5.3.tar.gz
Source079: https://github.com/pqwy/notty/archive/v0.1.1/notty-v0.1.1.tar.gz
Source080: https://forge.ocamlcore.org/frs/download.php/1669/oasis-0.4.8.tar.gz
Source081: http://download.camlcity.org/download/findlib-1.7.1.tar.gz
Source082: http://ocamlgraph.lri.fr/download/ocamlgraph-1.8.5.tar.gz
Source083: http://forge.ocamlcore.org/frs/download.php/379/ocamlify-0.0.1.tar.gz
Source084: https://forge.ocamlcore.org/frs/download.php/1544/ocamlmod-0.0.8.tar.gz
Source085: https://github.com/mjambon/ocamlscript/archive/v2.0.4/ocamlscript-v2.0.4.tar.gz
Source086: https://github.com/pqwy/ocb-stubblr/releases/download/v0.1.0/ocb-stubblr-0.1.0.tbz
Source087: https://github.com/polazarus/oclock/archive/v0.4.tar.gz
Source088: https://github.com/OCamlPro/ocp-indent/archive/1.5.3/ocp-indent-1.5.3.tar.gz
Source089: https://github.com/OCamlPro/ocplib-endian/archive/1.0/ocplib-endian-1.0.tar.gz
Source090: https://github.com/sagotch/ocveralls/archive/3.3.4/ocveralls-3.3.4.tar.gz
Source091: https://github.com/ocaml-omake/omake/archive/omake-0.10.1.tar.gz
Source092: http://pw374.github.io/distrib/omd/omd-1.3.0.tar.gz
Source093: https://github.com/ocaml/opam/archive/1.2.2/opam-1.2.2.tar.gz
Source094: https://github.com/xapi-project/ocaml-opasswd/archive/v1.0.1/ocaml-opasswd-1.0.1.tar.gz
Source095: http://forge.ocamlcore.org/frs/download.php/1258/ounit-2.0.0.tar.gz
Source096: https://github.com/simonjbeaumont/ocaml-pci/archive/v1.0.0/ocaml-pci-v1.0.0.tar.gz
Source097: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_assert-113.33.03.tar.gz
Source098: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_bench-113.33.03.tar.gz
Source099: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_bin_prot-113.33.03.tar.gz
Source100: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_compare-113.33.03.tar.gz
Source101: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_core-113.33.03.tar.gz
Source102: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_custom_printf-113.33.03.tar.gz
Source103: https://github.com/whitequark/ppx_deriving/archive/v4.1/ppx_deriving-v4.1.tar.gz
Source104: https://github.com/whitequark/ppx_deriving_yojson/archive/v3.0/ppx_deriving_yojson-v3.0.tar.gz
Source105: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_driver-113.33.03.tar.gz
Source106: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_enumerate-113.33.03.tar.gz
Source107: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_expect-113.33.03.tar.gz
Source108: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_fail-113.33.03.tar.gz
Source109: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_fields_conv-113.33.03.tar.gz
Source110: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_here-113.33.03.tar.gz
Source111: https://github.com/whitequark/ppx_import/archive/v1.1/ppx_import-v1.1.tar.gz
Source112: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_inline_test-113.33.03.tar.gz
Source113: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_jane-113.33.03.tar.gz
Source114: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_let-113.33.03.tar.gz
Source115: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_optcomp-113.33.03.tar.gz
Source116: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_pipebang-113.33.03.tar.gz
Source117: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_sexp_conv-113.33.03.tar.gz
Source118: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_sexp_message-113.33.03.tar.gz
Source119: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_sexp_value-113.33.03.tar.gz
Source120: https://github.com/alainfrisch/ppx_tools/archive/5.0+4.02.0/ppx_tools-5.0+4.02.0.tar.gz
Source121: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_type_conv-113.33.03.tar.gz
Source122: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_typerep_conv-113.33.03.tar.gz
Source123: https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_variants_conv-113.33.03.tar.gz
Source124: https://github.com/ocaml/ocaml-re/archive/1.7.1/ocaml-re-1.7.1.tar.gz
Source125: http://erratique.ch/software/react/releases/react-1.2.0.tbz
Source126: https://github.com/janestreet/result/archive/1.2/result-1.2.tar.gz
Source127: http://erratique.ch/software/rresult/releases/rresult-0.5.0.tbz
Source128: https://ocaml.janestreet.com/ocaml-core/113.33/files/sexplib-113.33.03.tar.gz
Source129: https://github.com/vincenthz/ocaml-sha/archive/ocaml-sha-v1.9.tar.gz
Source130: https://github.com/mirage/shared-memory-ring/archive/v1.3.0/shared-memory-ring-v1.3.0.tar.gz
Source131: https://github.com/savonet/ocaml-ssl/releases/download/0.5.3/ocaml-ssl-0.5.3.tar.gz
Source132: https://github.com/rgrinberg/stringext/archive/v1.4.3/stringext-v1.4.3.tar.gz
Source133: http://deb.debian.org/debian/pool/main/s/syslog-ocaml/syslog-ocaml_1.4.orig.tar.gz
Source134: https://github.com/mirage/mirage-tcpip/archive/v2.8.1/mirage-tcpip-v2.8.1.tar.gz
Source135: http://erratique.ch/software/topkg/releases/topkg-0.8.1.tbz
Source136: http://erratique.ch/software/topkg/releases/topkg-0.8.1.tbz
Source137: https://ocaml.janestreet.com/ocaml-core/113.00/files/type_conv-113.00.02.tar.gz
Source138: https://ocaml.janestreet.com/ocaml-core/113.33/files/typerep-113.33.03.tar.gz
Source139: http://github.com/OCamlPro/typerex-build/archive/1.99.17-beta/typerex-build-1.99.17-beta.tar.gz
Source140: https://github.com/ocaml/uchar/releases/download/v0.0.1/uchar-0.0.1.tbz
Source141: https://github.com/mirage/ocaml-uri/archive/v1.9.2/ocaml-uri-v1.9.2.tar.gz
Source142: https://github.com/OCamlPro/opam-user-setup/archive/0.6/opam-user-setup-0.6.tar.gz
Source143: https://github.com/diml/utop/archive/1.19.3/utop-1.19.3.tar.gz
Source144: http://erratique.ch/software/uucp/releases/uucp-1.1.0.tbz
Source145: http://erratique.ch/software/uuidm/releases/uuidm-0.9.6.tbz
Source146: http://erratique.ch/software/uuseg/releases/uuseg-0.9.0.tbz
Source147: http://erratique.ch/software/uutf/releases/uutf-0.9.4.tbz
Source148: https://ocaml.janestreet.com/ocaml-core/113.33/files/variantslib-113.33.03.tar.gz
Source149: http://erratique.ch/software/vg/releases/vg-0.8.2.tbz
Source150: https://github.com/mirage/ocaml-vhd/archive/v0.8.0/ocaml-vhd-v0.8.0.tar.gz
Source151: http://erratique.ch/software/webbrowser/releases/webbrowser-0.6.1.tbz
Source152: http://erratique.ch/software/xmlm/releases/xmlm-1.2.0.tbz
Source153: https://github.com/mjambon/yojson/archive/v1.3.3/yojson-v1.3.3.tar.gz
Source154: https://forge.ocamlcore.org/frs/download.php/1574/zarith-1.4.1.tgz
Source155: https://github.com/diml/zed/archive/1.4/zed-1.4.tar.gz
Source156: https://github.com/jonludlam/message-switch/archive/v0.10.99/message-switch-v0.10.99.tar.gz
Source157: http://erratique.ch/software/mtime/releases/mtime-0.8.1.tbz
Source158: http://github.com/jonludlam/ocaml-rpc/archive/ppx2/ocaml-rpc.tar.gz
Source159: http://github.com/jonludlam/shared-block-ring/archive/ppx/shared-block-ring.tar.gz
Source160: http://github.com/juergenhoetzel/ocaml-systemd/archive/master/systemd.tar.gz
Source161: https://github.com/mseri/backtrace/archive/ppx/xapi-backtrace.tar.gz
Source162: https://github.com/mseri/forkexecd/archive/ppx/xapi-forkexecd.tar.gz
Source163: http://github.com/jonludlam/xcp-idl/archive/ppx/xcp-idl.tar.gz
Source164: http://github.com/xapi-project/xcp-inventory/archive/master/xapi-inventory.tar.gz
Source165: http://github.com/xapi-project/netdev/archive/master/xapi-netdev.tar.gz
Source166: http://github.com/xapi-project/xcp-rrd/archive/master/xcp-rrd.tar.gz
Source167: http://github.com/xapi-project/stdext/archive/master/xapi-stdext.tar.gz
Source168: http://github.com/xapi-project/tapctl/archive/master/xapi-tapctl.tar.gz
Source169: http://github.com/xapi-project/xapi-test-utils/archive/master/xapi-test-utils.tar.gz
Source170: http://github.com/jonludlam/xen-api-client/archive/new-ocaml-rpc/xen-api-client.tar.gz
Source171: https://github.com/mirage/ocaml-xenstore/archive/v1.3.0/ocaml-xenstore-v1.3.0.tar.gz
Source172: https://github.com/djs55/ocaml-xenstore-clients/archive/0.9.4/ocaml-xenstore-clients-0.9.4.tar.gz
BuildRequires: opam
BuildRequires: rsync

%description
Opam repository containing all upstream and development libraries
required for building the OCaml components in the XS Toolstack.

%prep
%setup -q -n xs-opam-master
# link all source files into src/
mkdir src
grep -v '^#' sources.txt | while read p url
do
  file=$(basename $url)
  (cd src; test -f $file || ln -s ../../../SOURCES/$file .)
done
# rename all URL files such that we only use archive
find packages -type f -name url -exec mv {} {}.off \;

%build
make

%install
mkdir -p %{buildroot}/usr/share/opam-repository
rsync -avz  archives packages %{buildroot}/usr/share/opam-repository/
chmod o+w -R %{buildroot}/usr/share/opam-repository

# create opam root
mkdir -p %{buildroot}/usr/lib/opamroot
chmod 777 %{buildroot}/usr/lib/opamroot


%files
/usr/share/opam-repository
/usr/lib/opamroot
%attr(777, root, root) /usr/lib/opamroot

%changelog
* Tue Dec 20 2016 Christian Lindig <christian.lindig@citrix.com> - 0.0.1-1 
- Initial version

